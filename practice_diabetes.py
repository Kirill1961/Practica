# -*- coding: utf-8 -*-
""" üö©–ü—Ä–∞–∫—Ç–∏–∫–∞ diabet –û—Ç–±–æ—Ä –ü—Ä–∏–∑–Ω–∞–∫–æ–≤ triu  roc_auc plt slice DF C Series mutual.ipynb


Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/15bRbEVDsDFdyfHu7szPtrC8k1FzDL3eh

# START
"""

# !pip uninstall gdown -y && pip install gdown  # —É—Å—Ç–∞–Ω–æ–≤–∫–∞ gdown
import os
os.getcwd()
from os import read
# from google.colab import drive  # –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–ª–∏—Å—å –∏ –∑–∞—Ö–æ–¥–∏–º –≤ google drive
from glob import glob
# drive.mount('/content/drive')  # –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø  –∫ —Ñ–∞–π–ª–∞–º —Ö—Ä–∞–Ω—è—â–∏–º—Å—è –Ω–∞ Google Drive

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import matplotlib as mpl
import seaborn as sns
import matplotlib.colors
import matplotlib.ticker as mtick

from sklearn.feature_selection import SelectKBest, mutual_info_classif, f_regression, f_classif, chi2
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler

from sklearn.linear_model import LogisticRegression
from sklearn.ensemble import RandomForestClassifier

from sklearn.metrics import accuracy_score, roc_auc_score, mean_squared_error

from sklearn.metrics import confusion_matrix, RocCurveDisplay, classification_report
# from sklearn.metrics import confusion_matrix, classification_report

from mlxtend.feature_selection import SequentialFeatureSelector
from mlxtend.feature_selection import ExhaustiveFeatureSelector
from sklearn.feature_selection import RFE

"""#  –†–∞–±–æ—Ç–∞ –ø–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è –î–∏–∞–±–µ—Ç --- –î–ê / –ù–ï–¢"""

df = pd.read_csv('D:\Eduson_data\diabetes_binary_5050split_health_indicators_BRFSS2015.csv')
df.head(10).T
df.info()

# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è ‚óæ –æ—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
# * –≠–∫—Å–ø–µ—Ä—Ç–Ω–∞—è –æ—Ü–µ–Ω–∫–∞
# * –í–∏–∑—É–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞
# * –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞


print(df[df.duplicated()].columns, '\n')  # –ò–º–µ–Ω–∞ —Å—Ç–æ–ª–±—Ü–æ–≤ —Å –¥—É–±–ª–∏–∫–∞—Ç–∞–º–∏
print(df[df.duplicated()].sum(), '\n')  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ —É–¥–∞–ª–µ–Ω–∏—è

print('% –î—É–±–ª–∏–∫–∞—Ç–æ–≤ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–æ—Ä—è–¥–∫–∞/—Ä–∞–∑–º–µ—Ä–∞ DF : ' , '\n', f'{df[df.duplicated()].sum() / (len(df) / 100)}', '\n')  # % –î—É–±–æ–∏–∫–∞—Ç–æ–≤ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–æ—Ä—è–¥–∫–∞ DF
print('1 –û–±—â–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –î—É–±–ª–∏–∫–∞—Ç–æ–≤ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–æ—Ä—è–¥–∫–∞/—Ä–∞–∑–º–µ—Ä–∞ DF : ', '\n', f'{df.duplicated().sum() / (len(df) / 100)}', '\n')
print('2 DF –±–µ–∑ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ / –Ω–∞ –ø–æ–ª–Ω—ã–π —Ä–∞–∑–º–µ—Ä DF : ', '\n', f'{(len(df) - len(df.drop_duplicates()))/ len(df)}')

#  –°–æ–∑–¥–∞–ª–∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫

df['surprise'] = 5

df.describe().T

"""# –£–¥–∞–ª—è–µ–º –∏–∑–±—ã—Ç–æ—á–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫ surprise"""

# df = df.drop(['surprise'], axis=1)
df.info()

"""# –ò–∑–º–µ–Ω–∏—Ç—å –∏–º—è Series"""

# –ß–µ—Ä–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
df_rename = df.nunique()

df_rename.name = 'unique_samples'

print('Num unique samples : \n', df.nunique())

print(df_rename)

"""# –í—ã–¥–µ–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö ‚óæ –æ—Ç–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö, —á–∏—Å–ª–æ–≤—ã—Ö

MY ‚óæ –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π üö´
* `Python —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è` –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ, —Ç–æ–ª—å–∫–æ` pandas –∫–æ–¥`
"""

target = df['Diabetes_binary']

dfu = df.nunique()

# 1Ô∏èÔ∏è
num_var = [column for column, unique in zip(dfu.index, dfu) if unique > 2]

# 2Ô∏è‚É£
# df.nunique() - —ç—Ç–æ Series
num_var = df.nunique()[(df.nunique() > 2) & (target.name not in df.nunique().index)].index



# 1Ô∏èÔ∏è
bool_var = [column for column, unique in zip(df.nunique().index, df.nunique()) if unique == 2]
# 2Ô∏è‚É£
bool_var = [var for var in df.nunique().index if df.nunique()[var] == 2 and var != target.name]


print('num_var : \n', num_var, '\n')
print('bool_var : \n', bool_var, '\n')
print(df.CholCheck.value_counts())


"""# ‚óª HERE ‚óæ –û—Ç–±–æ—Ä –±–∏–Ω–∞—Ä–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
* Pandas —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
"""

# target = 'Diabetes_binary'


bool_var = df.nunique()[df.nunique() == 2].index.drop('Diabetes_binary')

# –ú–µ—Ç–æ–¥–æ–º –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏ —Å–ø–∏—Å–∫–∞ bool_var
num_var = [i for i in df.columns if i not in bool_var and i != 'Diabetes_binary']

print(num_var, '\n')
print(bool_var)

"""#  normalize=True

* `value_counts(0)` ‚Äî –ø–æ–∫–∞–∂–µ—Ç `–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ`.

* `value_counts(1)` ‚Äî –ø–æ–∫–∞–∂–µ—Ç `–¥–æ–ª–∏`.

#  .spines –∏ .set_visible(False)
 * —ç—Ç–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–Ω–µ—à–Ω–µ–≥–æ –≤–∏–¥–∞ —Ä–∞–º–∫–∏ –≥—Ä–∞—Ñ–∏–∫–∞
    * `.spines` -- –≠—Ç–æ –≥—Ä–∞–Ω–∏—Ü—ã (—Ä–∞–º–∫–∏) –≤–æ–∫—Ä—É–≥ –≥—Ä–∞—Ñ–∏–∫–∞, –∏ –æ–Ω–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ –≤–∏–¥–µ —Å–ª–æ–≤–∞—Ä—è `{'top': Spine, 'bottom': Spine, 'left': Spine, 'right': Spin}`
    * `.spines[['top', 'right']] ` -- –≠—Ç–æ –≤—ã–±–æ—Ä –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ä–∞–º–æ–∫, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–µ—Ä—Ö–Ω–µ–π –∏ –ø—Ä–∞–≤–æ–π.
    * `.set_visible(False)` -- –≠—Ç–æ –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–∫–ª—é—á–∞–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —ç—Ç–∏—Ö —Ä–∞–º–æ–∫.

# 1Ô∏è‚É£–°–ø–æ—Å–æ–± Eduson
# """

df['Diabetes_binary'].value_counts(1).plot(kind='barh',figsize=(10, 2),
                                           color='#53AEFF').spines[['top', 'right']].set_visible(True);
plt.title('Diabetes_binary Distribution (%)', fontsize=10)
plt.yticks(ticks=[0,1], labels=['Non-Diabetic', 'Diabetic']);
# plt.show()


"""2Ô∏è‚É£ –°–ø–æ—Å–æ–± GPT - –ü—Ä–∞–≤–∏–ª—å–Ω–æ
* `ax.spines` --- `—Ä–∞–∑–¥–µ–ª—å–Ω–æ`
"""

ax = df['Diabetes_binary'].value_counts(1).plot(kind='barh', figsize=(10, 2), color='#FF851B')
ax.spines['top'].set_visible(False)
ax.spines['right'].set_visible(False)
# plt.show()


"""# corrwith ‚óæ –º–µ—Ä–∞ –ª–∏–Ω–µ–π–Ω–æ–π —Å–≤—è–∑–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Å —Ü–µ–ª–µ–≤–æ–π"""



# print(df.drop('Diabetes_binary', axis=1).columns)

(df.drop('Diabetes_binary', axis=1)  # DF –±–µ–∑ —Ü–µ–ª–µ–≤–æ–π
   .corrwith(target)
   .sort_values(ascending=False)
   .plot(kind='bar', figsize=(12, 4), title="Diabetes_binary Correlation", alpha=0.8, zorder=3, color='#2E8CE3')
   .spines[['top','right', 'left']].set_visible(False)
   )
plt.grid(axis='y', linestyle='--', alpha=.5)
plt.xticks(rotation=45, ha='right', size=10)
# plt.show()


# """# corrwith ‚óæ –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è DF —Å —Ç–∞—Ä–≥–µ—Ç–æ–º + —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
# `corrwith` --- `–°—Ç–µ–ø–µ–Ω—å –ª–∏–Ω–µ–π–Ω–æ–π —Å–≤—è–∑–∏`, –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è DF —Å —Ç–∞—Ä–≥–µ—Ç–æ–º
# * `corrwith` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `Series`, –ø–æ—ç—Ç–æ–º—É —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã
# * `corr_df[corr_df[0] > 0.15]` - –ó–∞–¥–∞—ë–º `–ø–æ—Ä–æ–≥ –∫–æ—Ä–µ–ª—è—Ü–∏–∏`, –¥–ª—è `–æ—Ç–±–æ—Ä–∞` –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
# * `'corr_var'` --- –∏–º—è –∫–æ–ª–æ–Ω–∫–∏ –ø–æ –º–æ–µ–π –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–µ
# """
#
# corr_df = pd.DataFrame(df.drop(target, axis=1).corrwith(df.Diabetes_binary), columns=['corr_var']).sort_values('corr_var', ascending=False)
# corr_df[abs(corr_df['corr_var']) > 0.15]
#
# """# correlation threshold ‚óæ –ø–æ—Ä–æ–≥ –∫–æ—Ä–µ–ª—è—Ü–∏–∏
# 1Ô∏è‚É£ –Ω–∞–∏–±–æ–ª—å—à–∞—è –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è, –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, –ø–æ –ø–æ—Ä–æ–≥—É 0.15
#
#
# """
#
# corr_df[abs(corr_df['corr_var'])>0.15]
#
# """2Ô∏è‚É£ –ø—Ä–∏–∑–Ω–∞–∫–∏, —É –∫–æ—Ç–æ—Ä—ã—Ö –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–µ–Ω—å—à–µ –ø–æ—Ä–æ–≥–∞"""
#
# corr_df[(abs(corr_df['corr_var'])<=0.15)]
#
# """# –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º
# * –ü—Ä–∏ –ª–∏–Ω–µ–π–Ω–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å—é –∫–æ—Ä–µ–ª—è—Ü–∏—è –±—É–¥–µ—Ç –≤—ã—Å–æ–∫–æ–π
# * `custom_cmap` ---  –∑–∞–¥–∞—ë–º —Ü–≤–µ–æ–≤—É—é –ø–∞–ª–∏—Ç—Ä—É –¥–ª—è heatmap
# * `mask` ---  —Å–æ–∑–¥–∞—ë—Ç—Å—è –ú–∞—Å–∫–∞ –∫–æ—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã
# * `np.ones_like` --- —Å–æ–∑–¥–∞—ë—Ç—Å—è `–µ–¥–∏–Ω–∏—á–Ω–∞—è` –º–∞—Ç—Ä–∏—Ü–∞ –ø–æ —Ä–∞–∑–º–µ—Ä–∞–º –∏—Å—Ö–æ–¥–Ω–æ–π `data_heatmap.corr()`
# * `np.triu` --- –∏–∑ `np.ones_like` —Å–æ–∑–¥–∞—ë–º —Ç—Ä–µ—É–≥–æ–ª—å–Ω—É—é –≤–µ—Ä—Ö–Ω—é—é –º–∞—Ç—Ä–∏—Ü—É
#     * `dtype=bool` --- —Å–æ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –º–∞—Ç—Ä–∏—Ü—ã `True / False`
# * `annot=False` --- –ø–æ–¥–ø–∏—Å–∏ –∫–ª–µ—Ç–æ—á–µ–∫
# """
#
# data_heatmap = df
# custom_cmap = mpl.colors.LinearSegmentedColormap.from_list('custom', ['#2E4CE3', '#FFDDC4', '#582E09'])
#
# mask = np.triu(np.ones_like(data_heatmap.corr(), dtype=bool))
#
# # –†–∞–∑–º–µ—Ä—ã heatmap
# lenghtsize = 30
# fig, ax = plt.subplots(figsize=(lenghtsize,lenghtsize*.35), dpi=200)
#
#
# heatmap = sns.heatmap(data_heatmap.corr(), cmap=custom_cmap, mask=mask, annot=True, vmin=-.8, vmax=.8)
# heatmap.set_title('Correlation Heatmap', fontdict={'fontsize':24}, pad=16);
# ax.tick_params(axis='both', which='major', labelsize=20)
# plt.setp(ax.xaxis.get_majorticklabels(), rotation=45, ha='right');
#
# """# ‚óª ( X, —É ) - –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è
#
# * –¶–µ–ª–µ–≤–∞—è
# """
#
# y = df['Diabetes_binary']
# X = df.drop(['Diabetes_binary'], axis=1)
#
# """# chi2 –≤—Å–µ–≥–æ DF –±–µ–∑ –¶–µ–ª–µ–≤–æ–π
# * –ö—Ä–∞—Å–∏–≤–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ:
#   * –†–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∞—è –¢–∞–±–ª–∏—Ü–∞ –¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∞
#   * –ò–Ω–¥–µ–∫—Å—ã –ò–º–µ–Ω–æ–≤–∞–Ω—ã –ü—Ä–∏–∑–Ω–∞–∫–∞–º–∏
#   * –°—Ç–æ–ª–±—Ü—ã –∏–º–µ–Ω–æ–≤–∞–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ chi2
#   * –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é
# """
#
# chisquare = pd.DataFrame(chi2(X, y)).T.set_index(X.columns).rename(
#                 columns={0:'chi2_score', 1:"chi2_pValue"}).sort_values(by='chi2_score', ascending=False)
#
# chisquare
#
# """# ‚úÖ mutual_info_classif
#
#
# 1Ô∏è‚É£ - –¢–æ–ª—å–∫–æ –¥–ª—è `–î–∏—Å–∫—Ä–µ—Ç–Ω–æ–π` –¶–µ–ª–µ–≤–æ–π
#
# 2Ô∏è‚É£ - `–ü—Ä–∏–º–µ–Ω–∏–º` –¥–ª—è `cat_feat` –∏ `num_feat`
#
# 3Ô∏è‚É£ - –ª–æ–≤–∏—Ç `–ª—é–±—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏`
#
# ---
#
# # –í–∑–∞–∏–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è ‚óæ mutual_info_classif ‚óæ –û—Ç–ª–æ–≤ –ù–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç–µ–π
# üî• –í—ã—è–≤–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–π `–Ω–µ–ª–∏–Ω–µ–π–Ω–æ–π` —Å–≤—è–∑–∏ `–ø—Ä–∏–∑–Ω–∞–∫–æ–≤` —Å `—Ü–µ–ª–µ–≤–æ–π`
# * `mutual_info_classif(X, y)` --- –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç `–≤–∑–∞–∏–º–Ω—É—é` –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é `–º–µ–∂–¥—É` –∫–∞–∂–¥—ã–º `–ø—Ä–∏–∑–Ω–∞–∫–æ–º` –≤ X –∏ —Ü–µ–ª–µ–≤–æ–π `–ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π y`.
#   * —Å–∫–æ–ª—å–∫–æ `–±–∏—Ç` (–∏–ª–∏ `–µ–¥–∏–Ω–∏—Ü` –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏) `–ø—Ä–∏–∑–Ω–∞–∫ –¥–∞—ë—Ç` –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Ü–µ–ª–µ–≤–æ–π
#
# * –≠—Ç–æ `–Ω–µ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π` –∞–Ω–∞–ª–æ–≥ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ --- –æ–Ω –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç `–Ω–µ–ª–∏–Ω–µ–π–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏` –≤ `–Ω–µ–Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö` –µ–¥–µ–Ω–∏—Ü–∞—Ö
#
# * –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ –∏–∑ `n_features` –∑–Ω–∞—á–µ–Ω–∏–π: –¥–ª—è `–∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞` ‚Äî `—Å–∫–æ–ª—å–∫–æ –µ–¥–µ–Ω–∏—Ü` –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–Ω `–¥–∞—ë—Ç` –æ `—Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π`.
#     * `–ó–Ω–∞—á–µ–Ω–∏—è > 0` ‚Äî –ø—Ä–∏–∑–Ω–∞–∫ `–Ω–µ—Å—ë—Ç` –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ `Y`
#
#     * –ó–Ω–∞—á–µ–Ω–∏—è `=`  `0` ‚Äî –ø—Ä–∏–∑–Ω–∞–∫ `–±–µ—Å–ø–æ–ª–µ–∑–µ–Ω`
#
#
#
# * –≠—Ç–æ –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞, –∏ –æ–Ω–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç:
#
#     * —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
#
#     * –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–ª–∞—Å—Å–æ–≤
#
#     * –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
# """
#
# bool_vars = X.nunique()[X.nunique() == 2].index # –§–∏–ª—å—Ç—Ä –∏–º—ë–Ω –±–∏–Ω–∞—Ä–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
#
#
# mut_info = mutual_info_classif(X[bool_vars],y)  # –í–∑–∞–∏–º–Ω–∞—è –∏–Ω—Ñ. –ë–∏–Ω–∞—Ä–Ω—ã—Ö –ü—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ –¶–µ–ª–µ–≤–æ–π
# mut_df = pd.DataFrame(mut_info, columns=['Mutual_info'], index=X[bool_vars].columns) # —Å–æ–∑–¥–∞–Ω–∏–µ DF —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ c –í–∑–∞–∏–º–Ω–æ–π –∏–Ω—Ñ.
# mut_df.sort_values(by='Mutual_info',ascending=False)
#
#
# mut_df
#
# import math
# round(len(X.nunique()[X.nunique() == 2]) * 100 / len(X.columns), ndigits=0)
# # [i for i in X.columns if X[i].unique().size == 2]
# # len(X.columns)
# # len(X.nunique()[X.nunique() == 2])
#
# X.NoDocbcCost.unique()
#
# """# ‚≠ê‚óª baseline ‚óæRandomForestClassifier
#
# ‚úÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—é –Ω–µ –¥–µ–ª–∞–µ–º
#
# 1Ô∏è‚É£ ‚óª `random_state` - –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª
# """
#
# r_state = 42
#
# """2Ô∏è‚É£ ‚óª –ú–æ–¥–µ–ª—å –°–ª—É—á–∞–π–Ω—ã–π –õ–µ—Å
#  —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º random_state, rf_clf
# """
#
# rf_clf = RandomForestClassifier(random_state=r_state)
#
# """3Ô∏è‚É£ ‚óª —Ä–∞–∑–¥–µ–ª—è–µ–º –≤—ã–±–æ—Ä–∫–∏ train_test_split
#   * `stratify` -  –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏—Å—Ö–æ–¥–Ω–æ–µ  —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¶–µ–ª–µ–≤–æ–π  –≤ –û–±—É—á–∞—é—â–µ–π –∏ –¢–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∞—Ö
# """
#
# X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=r_state, stratify=y)
#
# """4Ô∏è‚É£ –æ–±—É—á–µ–Ω–∏–µ –∏ –ø—Ä–µ–¥–∏–∫—Ç y_rf_0"""
#
# rf_clf.fit(X_train, y_train)
#
# y_rf_0 = rf_clf.predict(X_test)
#
# """5Ô∏è‚É£  roc-auc score
# * roc_auc_score = 0,73  -> —ç—Ç–æ –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è
# * üî•üî• —ç—Ç–æ –æ—Ü–µ–Ω–∫–∞ —Ç–æ–≥–æ —á—Ç–æ` —É–º–µ–µ—Ç –ª–∏ –æ–Ω–∞ –æ—Ç–ª–∏—á–∞—Ç—å` –∫–ª–∞—Å—Å `1` –æ—Ç –∫–ª–∞—Å—Å–∞ `0` –ø–æ `–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è–º` –ø–æ` —à–∫–∞–ª–µ –æ—Ç 0 –¥–æ 1`
# * –≠—Ç–∞ –º–µ—Ç—Ä–∏–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç --- –Ω–∞—Å–∫–æ–ª—å–∫–æ `—Ö–æ—Ä–æ—à–æ` –º–æ–¥–µ–ª—å `—Ä–∞–Ω–∂–∏—Ä—É–µ—Ç –æ–±—ä–µ–∫—Ç—ã` –ø–æ —Å—Ç–µ–ø–µ–Ω–∏ `—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏` –≤ `–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–º –∫–ª–∞—Å—Å–µ`.
#     * –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç (positive class) ‚Äî —ç—Ç–æ –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –∫–ª–∞—Å—Å—É 1,
#     * –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç (negative class) ‚Äî —ç—Ç–æ –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –∫–ª–∞—Å—Å—É 0.
#
#
# """
#
# roc_auc_score(y_rf_0, y_test)
#
# """6Ô∏è‚É£ classification_report
# * `precision` -- –º–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–ª–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å—É `–±–æ–ª—å—à–µ` —á–µ–º –µ—Å—Ç—å, `–ø–µ—Ä–µ–±–æ—Ä`
#   * `precision=0,7` --- 70% `–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö` –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π `–ø—Ä–∞–≤–∏–ª—å–Ω–æ` –∞ `–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö` –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π 30% –Ω–µ—Ç
# * `recall`  -- –º–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–ª–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å—É `–º–µ–Ω—å—à–µ` —á–µ–º –µ—Å—Ç—å, `–Ω–µ–¥–æ–±–æ—Ä`
#   * `recall=0.75` --- 75% –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ `–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ`, –∞ 25% `–ø—Ä–æ–ø—É—â–µ–Ω–æ`
# * `support` -- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∞–ª—å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞ –≤ y_true
# * `f1-score` -- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç `–±–∞–ª–∞–Ω—Å` –º–µ–∂–¥—É `—Ç–æ—á–Ω–æ—Å—Ç—å—é` –∏ `–ø–æ–ª–Ω–æ—Ç–æ–π`
# """
#
# print(classification_report(y_rf_0, y_test))
#
# X.columns
#
# """7Ô∏è‚É£ –æ–±—É—á–µ–Ω–∏–µ –∏ –ø—Ä–µ–¥–∏–∫—Ç `y_rf_1` `–±–µ–∑ –ø—Ä–∏–∑–Ω–∞–∫–∞` >>> `NoDocbcCost`
# * `NoDocbcCost` --- ‚ú® `Mutual_info` –æ–ø—Ä–µ–¥–µ–ª–∏–ª —ç—Ç–æ—Ç –ø—Ä–∏–∑–Ω–∞–∫ –∫–∞–∫ `–Ω–µ –≤–ª–∏—è—é—â–∏–π` –Ω–∞ `–º–æ–¥–µ–ª—å`
# * –£–¥–∞–ª–∏–≤ `NoDocbcCost` —Ä–∞—Å—á–∏—Ç—ã–≤–∞–µ–º –Ω–∞ –ø–æ–≤—ã—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞
# """
#
# rf_clf.fit(X_train.drop(['NoDocbcCost'], axis=1), y_train)  # –û–±—É—á–µ–Ω–∏–µ
#
# y_rf_1 = rf_clf.predict(X_test.drop(['NoDocbcCost'], axis=1))  #  –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –¢–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ
#
# """8Ô∏è‚É£ roc_auc_score
# * `roc_auc_score` –ø–æ—á—Ç–∏ `–Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è` , —Ö–æ—Ç—è –ø—Ä–∏–∑–Ω–∞–∫ `NoDocbcCost` –º—ã —Å—á–∏—Ç–∞–µ–º `–Ω–µ–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º`
# """
#
# roc_auc_score(y_rf_1, y_test)
#
# """9Ô∏è‚É£ classification_report"""
#
# print(classification_report(y_rf_1, y_test))
#
# X.groupby(X['NoDocbcCost']).count()
#
# """# slice DF"""
#
# z = X['NoDocbcCost'].value_counts()
# y = X['NoDocbcCost']
#
# print('\n', z[1], '\n')
#
# print(X.loc[2:5, 'HighBP'	: 'Stroke'], '\n')
#
# y.groupby(level=0).sum() == 1
#
# """GPT ‚óæ –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ë–∞–ª–∞–Ω—Å –ë–∏–Ω–∞—Ä–Ω—ã—Ö –ü—Ä–∏–∑–Ω–∞–∫–æ–≤"""
#
# import pandas as pd
#
# # –ü—Ä–∏–º–µ—Ä: –ø—É—Å—Ç—å —É –Ω–∞—Å –µ—Å—Ç—å DataFrame df
# # –ó–∞–¥–∞—ë–º –ø–æ—Ä–æ–≥: –µ—Å–ª–∏ —á–∞—Å—Ç–æ—Ç–∞ —Å–∞–º–æ–≥–æ —á–∞—Å—Ç–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è > 99%, —Å—á–∏—Ç–∞–µ–º –ø—Ä–∏–∑–Ω–∞–∫ "–ø–æ—á—Ç–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º"
# threshold = 0.95
#
# # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–∏–∑–Ω–∞–∫–∏, —É –∫–æ—Ç–æ—Ä—ã—Ö –º–∞–∫—Å–∏–º—É–º –ø–æ value_counts –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ø–æ—Ä–æ–≥
# low_variance_cols = []
#
# for col in X.columns:
#     top_freq = X[col].value_counts(normalize=True, dropna=False).max()
#     if top_freq > threshold:
#         low_variance_cols.append((col, top_freq))
#
# # –í—ã–≤–æ–¥–∏–º –ø—Ä–∏–∑–Ω–∞–∫–∏ —Å –∏—Ö —á–∞—Å—Ç–æ—Ç–∞–º–∏
# for col, freq in low_variance_cols:
#     print(f"{col}: —á–∞—Å—Ç–æ—Ç–∞ —Å–∞–º–æ–≥–æ —á–∞—Å—Ç–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è = {freq:.2%}")
#
# """# –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ë–∞–ª–∞–Ω—Å –ë–∏–Ω–∞—Ä–Ω—ã—Ö –ü—Ä–∏–∑–Ω–∞–∫–æ–≤ ‚óæ –ü–æ –ø–æ—Ä–æ–≥—É
# * –°—á–∏—Ç–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —á–∞—Å—Ç–æ—Ç—É –æ–¥–Ω–æ–≥–æ –∏–∑ –±–∏–Ω–∞—Ä–æ–≤
# * —Ñ–∏–ª—å—Ç—Ä—É–µ–º –ø—Ä–∏–∑–Ω–∞–∫–∏ —Å —á–∞—Å—Ç–æ—Ç–æ–π –±–∏–Ω–∞—Ä–∞ > 70%
# """
#
# treshold = 0.75
# for i in X.columns:
#   if len(X[i].value_counts()) == 2:
#     freq = X[i].value_counts(normalize=True, dropna=False).max()
#     if freq <= treshold:
#       print(freq)
#
# """# üî• roc_auc_score ‚óæ SVM ‚óæ LogisticRegression ‚óæ f1_score
#
# * `y_pred = clf.predict(X_test) ` - `y_pred` —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ `0` –∏ `1`
#
#   * `roc_auc_score` - –∑–∞–¥—É–º—ã–≤–∞–ª—Å—è –∫–∞–∫ –º–µ—Ç—Ä–∏–∫–∞ `–∫–∞—á–µ—Å—Ç–≤–∞ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è` , –µ—Å–ª–∏ –Ω–∞ –≤—Ö–æ–¥–µ `0` –∏ `1` —Ç–æ —Ä–∞–Ω–∂–∏—Ä–∞ –Ω–µ—Ç
#
# * `f1_score`  - —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –±–∏–Ω–∞—Ä–∞–º–∏
#
# * üëç `roc_auc_score`(`y_test`, `y_score`) —Å—á–∏—Ç–∞–µ–º –ø–æ `y_score`, –≥–¥–µ `y_score` ‚Äî —ç—Ç–æ:
#
#   * –î–ª—è `LogisticRegression` ‚û°‚û° `predict_proba(X)[:, 1]` ‚Äî –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –∫ –∫–ª–∞—Å—Å—É `1`
#
#   * –î–ª—è `SVM` ‚û°‚û° `decision_function(X)` ‚Äî –æ—Ü–µ–Ω–∫–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ (`distance to hyperplane`)
#
# * üéà –î–ª—è `SVM`  —Ç–æ –∂–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `predict_proba(X)[:, 1]`, –Ω–æ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –Ω–∞–¥–æ —É–∫–∞–∑–∞—Ç—å `SVC(probability=True)`
#
# # –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ roc_auc_score ‚óæ predict_proba
# * üî• –ü—Ä–∏ `–ø–æ–æ—á–µ—Ä—ë–¥–Ω–æ–º` —É–¥–∞–ª–µ–Ω–∏–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
# * `predict_proba(...)[:, 1]` ---	–ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (`score`) –∫–ª–∞—Å—Å–∞ 1 (–Ω–æ –Ω–µ –º–µ—Ç–∫–∏), –¥–ª—è `–ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤  `roc_auc_score` .
#     * `[:, 1]` ‚Äî —ç—Ç–æ —Å—Ä–µ–∑ –ø–æ NumPy-–º–∞—Å—Å–∏–≤—É
#
#
# * –¢–∞–∫ –∫–∞–∫ `predict_proba` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `2-—Ö –º–µ—Ä–Ω—ã–π` –º–∞—Å—Å–∏–≤ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π, –º—ã –≤—ã–≤–æ–¥–∏–º `–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å` `–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ` `–∫–ª–∞—Å—Å–∞ 1`
#     * `1` - `–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π` –∫–ª–∞—Å—Å, —Å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏
#     * `0` - `–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π` –∫–ª–∞—Å—Å, —Å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏
#
# ```
# predict_proba - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ 1-–≥–æ –∏ 0-–≥–æ –∫–ª–∞—Å—Å–∞
#
# [[0.93, 0.07],  ‚Üê –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞: 7% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –±–æ–ª–µ–∑–Ω–∏, –≥–¥–µ 0.93 –∫–ª–∞—Å—Å 0 / 0.07 –∫–ª–∞—Å—Å 1
#  [0.21, 0.79],  ‚Üê –≤—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞: 79% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –±–æ–ª–µ–∑–Ω–∏, –≥–¥–µ 0.21 –∫–ª–∞—Å—Å 0 / 0.79 –∫–ª–∞—Å—Å 1
#  [0.56, 0.44],  ‚Üê –∏ —Ç.–¥.
#  ...]
# ```
# """
#
# # –ë–∞–∑–æ–≤–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ –Ω–∞ –≤—Å–µ—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö (–±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è)
# base_score = roc_auc_score(y_test, rf_clf.predict_proba(X_test)[:, 1])
#
# # –ü–æ–æ—á–µ—Ä—ë–¥–Ω–æ –∏—Å–∫–ª—é—á–∞–µ–º –∫–∞–∂–¥—ã–π –ø—Ä–∏–∑–Ω–∞–∫
# for feature in X.columns:
#     X_train_drop = X_train.drop(columns=[feature])
#     X_test_drop = X_test.drop(columns=[feature])
#
#     # –û–±—É—á–∞–µ–º –º–æ–¥–µ–ª—å –±–µ–∑ —ç—Ç–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞
#     rf_clf.fit(X_train_drop, y_train)
#
#     # –ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞
#     y_pred = rf_clf.predict_proba(X_test_drop)[:, 1]
#
#     # –°—á–∏—Ç–∞–µ–º AUC –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ
#     score = roc_auc_score(y_test, y_pred)
#
#     # –ü–µ—á–∞—Ç–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –∏–º—è –ø—Ä–∏–∑–Ω–∞–∫–∞, –Ω–æ–≤—ã–π AUC –∏ —Ä–∞–∑–Ω–∏—Ü—É —Å –±–∞–∑–æ–π
#     print(f'{feature:25} | ROC AUC: {score:.4f} | Œî: {score - base_score:.4f}')
#
# """# ‚≠ê embedded ‚óæ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –æ—Ç–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö ‚óæ LogisticRegression
#
# ‚úÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
#
# 1Ô∏è‚É£
#
# `fit_transform(X_train)`:
#
#   * –°–Ω–∞—á–∞–ª–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç `—Å—Ä–µ–¥–Ω–µ–µ` –∏ `—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ` –ø–æ `X_train` (fit),
#
#   * –ü–æ—Ç–æ–º `–ø—Ä–∏–º–µ–Ω—è–µ—Ç` –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ (`transform`).
#
# `transform(X_test)`:
#
#   * –ü—Ä–æ—Å—Ç–æ `–ø—Ä–∏–º–µ–Ω—è–µ—Ç` —É–∂–µ `–≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã` (mean –∏ std) –∏–∑ `X_train`,
#
#   * `–ò—Å–ø–æ–ª—å–∑—É–µ—Ç` –∏—Ö –¥–ª—è `–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è` X_test.
#
# ```
# # –í—ã–±—Ä–∞–Ω –∫–æ–¥–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç
# ```
# """
#
# scaler = StandardScaler()
#
# X_train_sc = scaler.fit_transform(X_train) # –û–±—É—á–∏–ª–∏ StandardScaler –Ω–∞ train
# X_test_sc = scaler.transform(X_test)  # –ü—Ä–∏–º–µ–Ω—è–µ–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ, –æ–±—É—á–µ–Ω–Ω–æ–µ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ
#
# """2Ô∏è‚É£  –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä
#  * `penalty='l1'` --- —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è L1 –∫–æ—ç—Ñ—Ñ. `–ª–∏–Ω–µ–π–Ω–æ-–∫–æ—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ` –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏ `—Å–ª–∞–±—ã–µ` –ø—Ä–∏–∑–Ω–∞–∫–∏ `–ó–∞–Ω—É–ª—è–µ—Ç`
#  * `C=0.01`  --- –æ–±—Ä–∞—Ç–Ω–∞—è —Å–∏–ª–∞ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏:
#   * –ß–µ–º `–º–µ–Ω—å—à–µ` C, —Ç–µ–º `—Å–∏–ª—å–Ω–µ–µ` —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è `(–±–æ–ª—å—à–µ —à—Ç—Ä–∞—Ñ)`.
#   * –ß–µ–º –±–æ–ª—å—à–µ C, —Ç–µ–º –º–µ–Ω—å—à–µ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è.
#   * –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ `C=0.01` ‚Äî —ç—Ç–æ `—Å–∏–ª—å–Ω–∞—è —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è`, –º–Ω–æ–≥–æ –≤–µ—Å–æ–≤ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å 0
#  * `solver='liblinear'` --- –º–µ—Ç–æ–¥ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
#   * –≠—Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ—à–∞–µ—Ç —É—Ä–∞–≤–Ω–µ–Ω–∏–µ –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏.
#
#
# * –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç `penalty='l1'`
#
# * –•–æ—Ä–æ—à –¥–ª—è `–Ω–µ–±–æ–ª—å—à–∏—Ö` –∏ `—Å—Ä–µ–¥–Ω–∏—Ö` –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
#
# * –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏–∏ `penalty='l2'`, –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `'lbfgs'`, 'saga' `–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∫–æ–¥` –∏ –¥—Ä—É–≥–∏–µ.
#
# ‚òù ‚òù —Å–æ–∑–¥–∞—ë–º –æ–±—ä–µ–∫—Ç –º–æ–¥–µ–ª–∏ –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ —Å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
# """
#
# lr_clf = LogisticRegression(penalty='l1', C=0.01, solver='liblinear')
#
# """3Ô∏è‚É£ –æ–±—É—á–∞–µ–º –Ω–∞ —à–∫–∞–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö"""
#
# lr_clf.fit(X_train_sc, y_train)
#
# '''
# –≠—Ö–æ
# '''
# # LogisticRegression(C=0.01, penalty='l1', solver='liblinear')
#
# """‚ñ∂ –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –ø–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è"""
#
# lr_clf.coef_[0]
#
# """4Ô∏è‚É£ –ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ–º"""
#
# y_lr_0 = lr_clf.predict(X_test_sc)
#
# """5Ô∏è‚É£ roc_auc_score"""
#
# roc_auc_score(y_lr_0, y_test)
#
# """6Ô∏è‚É£ classification_report"""
#
# print(classification_report(y_lr_0, y_test))
#
# """7Ô∏è‚É£ —Å–º–æ—Ç—Ä–∏–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
#
# * `lr_clf.coef_` --- –≠—Ç–æ –º–∞—Å—Å–∏–≤ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ (–≤–µ—Å–æ–≤) –ø—Ä–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö.
#
# * `lr_clf.coef_` ‚Äî —ç—Ç–æ 2D-–º–∞—Å—Å–∏–≤, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤ –æ–±—â–µ–º —Å–ª—É—á–∞–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–Ω–æ–≥–æ –∫–ª–∞—Å—Å–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è `–º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏`).
#
# * –î–ª—è –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (0 –∏ 1) ‚Äî —ç—Ç–æ –º–∞—Å—Å–∏–≤ —Ä–∞–∑–º–µ—Ä–æ–º (1, n_features).
#
# üëç üëç –ö—Ä–∞—Å–∏–≤—ã–π –≤—ã–≤–æ–¥ —Ä–∞—Å—á–∏—Ç–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª—å—é –∫–æ—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
# * –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–æ—ç—Ñ—Ñ—é L1 –æ–±–Ω—É–ª–∏–ª–∞ –ø–æ—ç—Ç–æ–º—É —ç—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏ –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å
# """
#
# coef_df = pd.DataFrame(zip(X_train.columns, np.transpose(lr_clf.coef_[0])), columns=['features', 'coef'])
# coef_df
#
# """8Ô∏è‚É£  `feature importance` –ø–æ –º–Ω–µ–Ω–∏—é ‚ú® `—Å–ª—É—á–∞–π–Ω–æ–≥–æ –ª–µ—Å–∞`
# *
# """
#
# rf_clf.fit(X_train, y_train)
#
# y_predict = rf_clf.predict(X_test)
#
# """9Ô∏è‚É£ ‚ú®  `feature_importances_` --- –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–ª—è `—Å–ª—É—á–∞–π–Ω–æ–≥–æ –ª–µ—Å–∞` –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ—Ç `–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö` –º–µ—Ç–æ–¥–æ–≤ `–æ—Ç–±–æ—Ä–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤`"""
#
# rf_clf.feature_importances_
#
# """üîü `feature_importances_ `  --- –∫—Ä–∞—Å–∏–≤—ã–π –≤—ã–≤–æ–¥"""
#
# pd.DataFrame(zip(X_train.columns, rf_clf.feature_importances_), columns=['feature', 'importance']
#             ).sort_values(by='importance', ascending=False)
#
# """# ‚≠ê –û–±—ë—Ä—Ç–∫–∏
# * –ø–æ—Ç–æ–º—É —á—Ç–æ `–∞—Ä–≥—É–º–µ–Ω—Ç–æ–º` –º–µ—Ç–æ–¥–æ–≤ —è–≤–ª—è–µ—Ç—Å—è `–æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å`
# * –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –ø–µ—Ä–µ–±–æ—Ä
# * –ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ–±–æ—Ä
# """
#
# efs = ExhaustiveFeatureSelector(model, min_features=1, max_features=3, scoring='accuracy', cv=5)
# sfs = SequentialFeatureSelector(model, k_features=3, forward=True, scoring='r2', cv=5)
#
# """# ‚ùá –ü—Ä—è–º–æ–π –æ—Ç–±–æ—Ä
# –ù–∞—á–∏–Ω–∞–µ–º —Å `–ø—É—Å—Ç–æ–≥–æ` –Ω–∞–±–æ—Ä–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:
#
# –ù–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ:
#
# * –ü—Ä–æ–±—É–µ–º –¥–æ–±–∞–≤–∏—Ç—å –ø–æ `–æ–¥–Ω–æ–º—É –ø—Ä–∏–∑–Ω–∞–∫—É` –∏–∑ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è.
#
# * –û—Ü–µ–Ω–∏–≤–∞–µ–º –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ `roc_auc_score`, `accuracy`, `f1` –∏ —Ç.–ø.).
#
# * –í—ã–±–∏—Ä–∞–µ–º `–Ω–∞–∏–±–æ–ª–µ–µ` `–ø–æ–ª–µ–∑–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫` –∏ –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –≤ `—Ç–µ–∫—É—â–∏–π –Ω–∞–±–æ—Ä`.
#
# * –ü–æ–≤—Ç–æ—Ä—è–µ–º, –ø–æ–∫–∞:
#
#   * –º–æ–¥–µ–ª—å `—É–ª—É—á—à–∞–µ—Ç—Å—è` (–∏–ª–∏ `–Ω–µ —É—Ö—É–¥—à–∞–µ—Ç—Å—è`);
#
#   * –∏–ª–∏ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç `–ª–∏–º–∏—Ç` –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (`k_features`).
#
# üî∏ –≠—Ç–æ `–∂–∞–¥–Ω—ã–π –º–µ—Ç–æ–¥` ‚Äî –æ–Ω –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ –ª—É—á—à–∏–π –Ω–∞–±–æ—Ä, `–Ω–æ –±—ã—Å—Ç—Ä–æ` –¥–∞—ë—Ç `—Ö–æ—Ä–æ—à–∏–π` —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
# """
#
# forw_feature = SequentialFeatureSelector(lr_clf, k_features='best', forward = True, n_jobs=-1)
# forw_feature.fit(X_train, y_train)
#
# """–í—ã–≤–æ–¥–∏–º –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–ª–µ–∑–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
#
# * `estimator =	lr_clf` ---	–ú–æ–¥–µ–ª—å, —Å –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—Ç–±–æ—Ä (–ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è –≤ —Ç–≤–æ—ë–º —Å–ª—É—á–∞–µ)
# * `k_features =	'best'`	–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–±–∏—Ä–∞–µ—Ç—Å—è –Ω–∞–∏–ª—É—á—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–ø–æ –º–µ—Ç—Ä–∏–∫–µ)
# * `forward =	True`	 --- –ü—Ä—è–º–æ–π –æ—Ç–±–æ—Ä, –¥–æ–±–∞–≤–ª—è–µ–º –ø—Ä–∏–∑–Ω–∞–∫–∏, –Ω–∞—á–∏–Ω–∞—è —Å –ø—É—Å—Ç–æ–≥–æ –Ω–∞–±–æ—Ä–∞
# * `n_jobs =	-1`	--- –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —è–¥—Ä–∞
# """
#
# features = list(forw_feature.k_feature_names_)
# features
#
# """# ‚ùá –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –æ—Ç–±–æ—Ä
#
# 1Ô∏è‚É£ —Å—Ç—Ä–æ–∏–º –º–æ–¥–µ–ª—å –Ω–∞ –ø–æ–ª–Ω–æ–º –Ω–∞–±–æ—Ä–µ `—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö` –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ `X_train_sc`
# """
#
# lr_clf.fit(X_train_sc, y_train)
#
# bfs = SequentialFeatureSelector(lr_clf, k_features='best', forward = False, n_jobs=-1)
#
# """2Ô∏è‚É£ –û–±—É—á–∞–µ–º"""
#
# bfs.fit(X_train_sc, y_train)
#
# """3Ô∏è‚É£ StandardScaler –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç  `X_train_sc` —ç—Ç–æ —Ç–∏–ø `numpy.ndarray` , –ø–æ—ç—Ç–æ–º—É –∏–º—ë–Ω –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–µ—Ç —Ç–æ–ª—å–∫–æ ‚Ññ —Å—Ç–æ–ª–±—Ü–æ–≤
# * `k_feature_names_` ‚Äî —ç—Ç–æ `–Ω–æ–º–µ—Ä–∞` —Å—Ç–æ–ª–±—Ü–æ–≤ `ndarray`
# """
#
# features = list(bfs.k_feature_names_)
#
# # –ü—Ä–æ–≤–µ—Ä–∏–º —Ç–∏–ø –≤–æ–∑–≤—Ä–∞—â—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
# print(list(map(type, features)))
# features
#
# """4Ô∏è‚É£ `HERE` –ö—Ä–∞—Å–∏–≤—ã–π –≤–∞—ã–≤–æ–¥ –æ—Ç–æ–±—Ä–∞–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
#
# """
#
# # HERE
# for i in range(len(features)):
#   print(X_train.columns.tolist()[int(features[i])])
#
# """5Ô∏è‚É£ MY"""
#
# # MY
# res = [X_train.columns[int(i)] for i in features]
# res
#
# """6Ô∏è‚É£7Ô∏è‚É£ `GPT ` –ö—Ä–∞—Å–∏–≤—ã–π –≤–∞—ã–≤–æ–¥ –æ—Ç–æ–±—Ä–∞–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
#
# üí• `bfs.k_feature_idx_` ‚Äî —ç—Ç–æ –∫–æ—Ä—Ç–µ–∂ —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª - `–∏–Ω–¥–µ–∫—Å–æ–≤` (–Ω–∞–¥–µ–∂–Ω–µ–µ –¥–ª—è –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –∫–æ–ª–æ–Ω–∫–∞–º DataFrame),
# """
#
# for feat in bfs.k_feature_idx_:
#     print(X_train.columns[feat])